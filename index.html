<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Cached Image : A WPF control that wraps the Image control to enable file-system based caching" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Cached Image</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/floydpink/CachedImage">View on GitHub</a>

          <h1 id="project_title">Cached Image</h1>
          <h2 id="project_tagline">A WPF control that wraps the Image control to enable file-system based caching</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/floydpink/CachedImage/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/floydpink/CachedImage/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="cachedimage--" class="anchor" href="#cachedimage--"><span class="octicon octicon-link"></span></a><a href="http://floydpink.github.io/CachedImage/">CachedImage</a> <a href="http://badge.fury.io/nu/CachedImage"><img src="https://badge.fury.io/nu/CachedImage.png" alt="NuGet version"></a> <a href="https://ci.appveyor.com/project/floydpink/cachedimage"><img src="https://ci.appveyor.com/api/projects/status/6tb8p301yio5fmh4" alt="Build status"></a>
</h1>

<p><a href="http://floydpink.github.io/CachedImage/"><img src="http://floydpink.github.io/CachedImage/images/logo.png" alt="logo" width="300px"></a></p>

<p>A WPF control that wraps the Image control to enable file-system based caching.</p>

<h3>
<a name="background" class="anchor" href="#background"><span class="octicon octicon-link"></span></a>Background</h3>

<p>If we use the native WPF <code>Image</code> control for displaying images over the HTTP protocol (by setting the <code>Source</code> to an http url), the image will be downloaded from the server every time the control is loaded. </p>

<p>The <code>Image</code> control present in this <code>CachedImage</code> library, wraps the native <code>Image</code> control to add a local file-system based caching capability. This control creates a local copy of the image on the first time an image is downloaded; to a configurable cache folder (defaults to <code>&lt;current-user/appdata/roaming&gt;\AppName\Cache</code>). All the subsequent loads of the control (or the page, window or app that contains the control), will display the image from the local file-system and will not download it from the server.</p>

<h3>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h3>

<ol>
<li>Install the NuGet package named <code>CachedImage</code> on the WPF project </li>
<li>
<p>Add a namespace reference to the <code>CachedImage</code> assembly on the Window/Usercontrol <code>xmlns:cachedImage="clr-namespace:CachedImage;assembly=CachedImage"</code> as in the example <code>Window</code> below:</p>

<div class="highlight highlight-xml"><pre><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"MyWindow1"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:d=</span><span class="s">"http://schemas.microsoft.com/expression/blend/2008"</span>
        <span class="na">xmlns:mc=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
        <span class="na">xmlns:cachedImage=</span><span class="s">"clr-namespace:CachedImage;assembly=CachedImage"</span><span class="nt">&gt;</span>

<span class="nt">&lt;/Window&gt;</span>
</pre></div>
</li>
<li>
<p>Use the control and set or bind the <code>ImageUrl</code> attribute:</p>

<div class="highlight highlight-xml"><pre>
    <span class="nt">&lt;cachedImage:Image</span> <span class="na">ImageUrl=</span><span class="s">"{Binding LargeImageUrl, IsAsync=True}"</span><span class="nt">&gt;</span>  <span class="nt">&lt;/cachedImage:Image&gt;</span>
</pre></div>
</li>
<li>
<p>As it is only a wrapper, all the XAML elements that could be used with the <code>Image</code> control are valid here as well:</p>

<div class="highlight highlight-xml"><pre>
  <span class="nt">&lt;cachedImage:Image</span> <span class="na">ImageUrl=</span><span class="s">"{Binding LargeImageUrl, IsAsync=True}"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Image.ToolTip&gt;</span>This image gets cached to the file-system the first time it is downloaded<span class="nt">&lt;/Image.ToolTip&gt;</span>
  <span class="nt">&lt;/cachedImage:Image&gt;</span>
</pre></div>
</li>
<li>
<p>To change the cache folder location set the static string property named <code>AppCacheDirectory</code> of the <code>FileCache</code> class like this:</p>

<div class="highlight highlight-csharp"><pre>
  <span class="n">CachedImage</span><span class="p">.</span><span class="n">FileCache</span><span class="p">.</span><span class="n">AppCacheDirectory</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"{0}\\MyCustomCacheFolder\\"</span><span class="p">,</span>
                                <span class="n">Environment</span><span class="p">.</span><span class="n">GetFolderPath</span><span class="p">(</span><span class="n">Environment</span><span class="p">.</span><span class="n">SpecialFolder</span><span class="p">.</span><span class="n">ApplicationData</span><span class="p">));</span>
</pre></div>
</li>
<li>Please note that the control does not consider <code>Cache-Control</code> or <code>Expires</code> headers. Unless the cache folder (or specific files in it) gets deleted, the control will not fetch the file again from the server. The application could let the end-user empty the cache folder as done in the <a href="https://github.com/flickr-downloadr/flickr-downloadr">flickr downloadr</a> application that uses this control.</li>
</ol><h3>
<a name="thanks" class="anchor" href="#thanks"><span class="octicon octicon-link"></span></a>Thanks</h3>

<p>All of the code in this library is from the answers on a Stack Overflow question titled - <a href="http://stackoverflow.com/questions/1878060/how-do-i-cache-images-on-the-client-for-a-wpf-application">How do I cache images on the client for a WPF application?</a>. </p>

<p>Thanks to <a href="http://stackoverflow.com/questions/1878060/how-do-i-cache-images-on-the-client-for-a-wpf-application/5175424#5175424">the wonderful code there</a> by <a href="http://stackoverflow.com/users/641271/jeroen-van-langen">Jeroen van Langen</a> and <a href="http://stackoverflow.com/questions/1878060/how-do-i-cache-images-on-the-client-for-a-wpf-application/12638859#12638859">the modification to make it bindable</a> by <a href="http://stackoverflow.com/users/367287/ivan-leonenko">Ivan Leonenko</a>.</p>

<h3>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h3>

<p><a href="https://raw.github.com/floydpink/CachedImage/master/LICENSE">MIT License</a></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Cached Image maintained by <a href="https://github.com/floydpink">floydpink</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-36383654-5");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
